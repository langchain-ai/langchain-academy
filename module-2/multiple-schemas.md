# Multiple Schemas

## Review 

状態スキーマとreducersについて説明しました。

通常、すべてのグラフノードは単一のスキーマとやり取りします。

また、この単一のスキーマには、グラフの入力と出力のキー/チャネルが含まれます。

## Goals

しかし、これについてより詳細な制御が必要なケースがあります：

* 内部ノードは、グラフの入力/出力で*必要でない*情報を渡すことがあります。

* グラフに異なる入力/出力スキーマを使用したい場合もあります。例えば、出力は関連する単一の出力キーのみを含むことがあります。

複数のスキーマを使用してグラフをカスタマイズする方法をいくつか説明します。

## Private State

まず、ノード間の[プライベートな状態](https://langchain-ai.github.io/langgraph/how-tos/pass_private_state/)を渡すケースについて説明します。

これは、グラフの中間的な実行ロジックの一部として必要だが、グラフ全体の入力や出力には関係のないものに役立ちます。

`OverallState`と`PrivateState`を定義してみましょう。

`node_2`は入力として`PrivateState`を使用しますが、`OverallState`に書き込みます。

[コードブロックは原文のまま]

`baz`は`PrivateState`にのみ含まれます。

`node_2`は入力として`PrivateState`を使用しますが、`OverallState`に書き込みます。

したがって、`baz`は`OverallState`に含まれていないため、グラフの出力から除外されることがわかります。

## Input / Output Schema

デフォルトでは、`StateGraph`は単一のスキーマを受け取り、すべてのノードはそのスキーマと通信することが期待されます。

しかし、[グラフに明示的な入力および出力スキーマを定義する](https://langchain-ai.github.io/langgraph/how-tos/input_output_schema/?h=input+outp)ことも可能です。

このような場合、多くのケースで、グラフの操作に関連する*すべての*キーを含む「内部」スキーマを定義します。

しかし、特定の`input`および`output`スキーマを使用して入力と出力を制限します。

まず、単一のスキーマでグラフを実行してみましょう。

[コードブロックは原文のまま]

`OverallState`のすべてのキーが呼び出しの出力に含まれていることに注意してください。

では、グラフで特定の`input`および`output`スキーマを使用してみましょう。

ここで、`input`/`output`スキーマはグラフの入力および出力で許可されるキーに*フィルタリング*を実行します。

また、各ノードの入力スキーマを指定するために型ヒント`state: InputState`を使用できます。

これは、グラフが複数のスキーマを使用している場合に重要です。

以下では、例えば`answer_node`の出力が`OutputState`にフィルタリングされることを示すために型ヒントを使用しています。

[コードブロックは原文のまま]

`output`スキーマが出力を`answer`キーのみに制限していることがわかります。