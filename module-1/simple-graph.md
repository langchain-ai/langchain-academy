# 最もシンプルなグラフ

3つのノードと1つの条件付きエッジを持つシンプルなグラフを構築してみましょう。

## 状態(State)

まず、グラフの[状態(State)]を定義します。

状態スキーマは、グラフ内のすべてのノードとエッジの入力スキーマとして機能します。

キーの型ヒントを提供するPythonの`typing`モジュールの`TypedDict`クラスをスキーマとして使用しましょう。

## ノード

[ノード]は単なるPython関数です。

最初の位置引数は、上記で定義した状態です。

状態は上記で定義したスキーマを持つ`TypedDict`なので、各ノードは`state['graph_state']`でキー`graph_state`にアクセスできます。

各ノードは、状態キー`graph_state`の新しい値を返します。

デフォルトでは、各ノードが返す新しい値は、以前の状態値を[上書き]します。

## エッジ 

[エッジ]はノードを接続します。

通常のエッジは、例えば`node_1`から`node_2`に常に移動したい場合に使用されます。

[条件付きエッジ]は、ノード間を選択的にルーティングしたい場合に使用されます。

条件付きエッジは、何らかのロジックに基づいて次に訪問するノードを返す関数として実装されます。

## グラフの構築

次に、上記で定義した[コンポーネント]からグラフを構築します。

[StateGraphクラス]は使用できるグラフクラスです。

最初に、上記で定義した`State`クラスでStateGraphを初期化します。

その後、ノードとエッジを追加します。 

グラフへのユーザー入力を送信する特別なノードである[`START`ノード]を使用して、グラフの開始点を示します。

[`END`ノード]は終端ノードを表す特別なノードです。

最後に、グラフ構造の基本的なチェックを実行するために、グラフを[コンパイル]します。

グラフは[Mermaid図]として視覚化できます。

`invoke` はグラフ全体を同期的に実行します。

これにより、各ステップが完了するのを待ってから次のステップに進みます。

すべてのノードが実行された後、グラフの最終状態を返します。

この場合、`node_3 が完了した後の状態を返します。